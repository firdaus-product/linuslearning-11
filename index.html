<!DOCTYPE html>
<html lang="ms-MY">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Kemahiran Pemulihan: Asas Tambah (Pembelajaran)</title>
<script src="https://cdn.tailwindcss.com"></script>
<style>
  body{ box-sizing:border-box; }
  .card{ @apply bg-white rounded-xl shadow-lg; }

  /* ---------- DOMINO (fix overlap + precise count) ---------- */
  .domino{
    width:180px;height:100px;
    border:4px solid #4b5563;border-radius:18px;background:#fff;
    display:grid;grid-template-columns:1fr 1fr;overflow:hidden;
    box-shadow:0 6px 14px rgba(0,0,0,.12);
  }
  .domino .face{
    display:grid;grid-template-columns:repeat(3,1fr);grid-template-rows:repeat(3,1fr);
    align-items:center;justify-items:center;padding:10px;
  }
  .domino .face.left { border-right:6px solid #4b5563; padding-right:14px; }
  .domino .face.right{ padding-left:14px; }
  .pip{ width:12px;height:12px;border-radius:9999px; }
  .pip.black{ background:#111827; }  /* kiri */
  .pip.red{ background:#ef4444; }    /* kanan */
  .domino[draggable="true"]{ cursor:grab; }
  .domino.dragging{ opacity:.6; transform:scale(.98); cursor:grabbing; }

  /* umum */
  .dropzone-dashed{ border:4px dashed #94a3b8; }
  .bounce{ animation:b .5s ease-in-out; }
  @keyframes b{0%,100%{transform:translateY(0)}50%{transform:translateY(-6px)}}
</style>
</head>
<body class="bg-gradient-to-br from-blue-50 to-purple-50 min-h-screen">
  <main class="container mx-auto max-w-6xl p-4">
    <!-- Header -->
    <header class="text-center mb-4">
      <h1 class="text-3xl md:text-4xl font-extrabold text-purple-800">
        ğŸ§® Kemahiran Pemulihan: Asas Tambah (Pembelajaran)
      </h1>
      <p class="text-slate-600 mt-1">Untuk murid 5â€“9 tahun Â· Tiada soalan/markah â€” hanya penerangan & penerokaan</p>
    </header>

    <!-- Info Bar -->
    <section class="bg-yellow-100 border-l-4 border-yellow-500 p-4 rounded-lg shadow-sm mb-5 flex items-center justify-between">
      <div class="flex items-center gap-3">
        <span class="text-2xl">ğŸ’¡</span>
        <p id="info" class="text-lg font-medium text-slate-800">Klik butang aktiviti di bawah untuk mula.</p>
      </div>
      <button id="speakBtn" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg text-xl">ğŸ”Š</button>
    </section>

    <!-- Stage -->
    <section id="stage" class="card p-6 min-h-[360px] flex items-center justify-center text-center">
      <div>
        <div class="text-6xl mb-3">ğŸ¯</div>
        <h2 class="text-2xl font-bold text-slate-800">Pilih aktiviti untuk mula belajar!</h2>
        <p class="text-slate-600 mt-2">Semua aktiviti berbentuk pembelajaran/penjelasan â€” tiada â€œbetul/salahâ€.</p>
      </div>
    </section>

    <!-- Controls -->
    <section class="mt-5">
      <div class="grid grid-cols-1 md:grid-cols-5 gap-3">
        <button onclick="start(1)" class="bg-sky-600 hover:bg-sky-700 text-white rounded-lg py-3 font-semibold">
          ğŸ§­ Aktiviti 1<br><span class="text-xs font-normal">Urutan & â€œLebih Satuâ€</span>
        </button>
        <button onclick="start(2)" class="bg-green-600 hover:bg-green-700 text-white rounded-lg py-3 font-semibold">
          ğŸ§µ Aktiviti 2<br><span class="text-xs font-normal">Kotak Manik (Penambahan)</span>
        </button>
        <button onclick="start(3)" class="bg-fuchsia-600 hover:bg-fuchsia-700 text-white rounded-lg py-3 font-semibold">
          ğŸ‘¨â€ğŸ‘©â€ğŸ‘§ Aktiviti 3<br><span class="text-xs font-normal">Keluarga Jumlah</span>
        </button>
        <button onclick="start(4)" class="bg-orange-600 hover:bg-orange-700 text-white rounded-lg py-3 font-semibold">
          ğŸ² Aktiviti 4<br><span class="text-xs font-normal">Domino Tambah</span>
        </button>
        <button onclick="start(5)" class="bg-amber-600 hover:bg-amber-700 text-white rounded-lg py-3 font-semibold">
          ğŸ”¢ Aktiviti 5<br><span class="text-xs font-normal">Kad Petak 100</span>
        </button>
      </div>

      <div class="flex justify-center gap-3 mt-4">
        <button onclick="resetStage()" class="bg-slate-500 hover:bg-slate-600 text-white px-5 py-2 rounded-lg font-semibold">ğŸ§½ Bersih</button>
        <button onclick="nextStep()" class="bg-indigo-600 hover:bg-indigo-700 text-white px-6 py-2 rounded-lg font-semibold">â¡ï¸ Seterusnya</button>
      </div>
    </section>
  </main>

<script>
/* -------------------- TTS helper -------------------- */
let ttsUnlocked = false, utt = null;
function speak(txt){ if(!ttsUnlocked) return;
  if(utt) speechSynthesis.cancel();
  setTimeout(()=>{
    utt = new SpeechSynthesisUtterance(txt);
    utt.lang = 'ms-MY'; utt.rate=.9; utt.pitch=1.1;
    const v = speechSynthesis.getVoices().find(v=>/ms|MY/i.test(v.lang));
    if(v) utt.voice = v;
    speechSynthesis.speak(utt);
  },100);
}
document.addEventListener('click',()=>{ if(!ttsUnlocked){ speechSynthesis.speak(new SpeechSynthesisUtterance('')); ttsUnlocked=true; }},{once:true});
document.getElementById('speakBtn').onclick = ()=>speak(document.getElementById('info').textContent);
const info = (t)=>{ document.getElementById('info').textContent=t; };

/* -------------------- State -------------------- */
let cur=0, step=0;
function start(n){ cur=n; step=0; [act1,act2,act3,act4,act5][n-1](); }
function nextStep(){ if(!cur){ info('Pilih aktiviti dahulu.'); return; } step++; start(cur); }
function resetStage(){
  cur=0; step=0;
  document.getElementById('stage').innerHTML = `
    <div>
      <div class="text-6xl mb-3">ğŸ¯</div>
      <h2 class="text-2xl font-bold text-slate-800">Pilih aktiviti untuk mula belajar!</h2>
      <p class="text-slate-600 mt-2">Semua aktiviti berbentuk pembelajaran/penjelasan â€” tiada â€œbetul/salahâ€.</p>
    </div>`;
  info('Klik butang aktiviti di bawah untuk mula.');
}

/* -------------------- Aktiviti 1: Urutan & â€œLebih Satuâ€ -------------------- */
function act1(){
  const n = 11 + (step % 10); // 11â€“20
  const ticks = Array.from({length:10},(_,i)=>11+i).map(x=>`<span class="w-10 text-center text-sm">${x}</span>`).join('');
  document.getElementById('stage').innerHTML = `
    <div class="w-full">
      <h2 class="text-2xl font-bold text-blue-800 mb-2">ğŸ§­ Urutan Nombor 11â€“20</h2>
      <p class="text-slate-600 mb-4">Gerakkan peluncur. Sistem membaca nombor sahaja; tekan â€œBaca Peneranganâ€ untuk huraian.</p>

      <div class="card p-5">
        <input id="sl" type="range" min="11" max="20" value="${n}" class="w-full accent-blue-600"/>
        <div class="flex justify-between mt-2 text-slate-500">${ticks}</div>

        <div class="mt-6 text-center">
          <div class="text-5xl font-extrabold">${n}</div>
          <div class="mt-3 flex gap-3 justify-center">
            <button id="sNum" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg">ğŸ”‰ Sebut Nombor</button>
            <button id="sDesc" class="bg-emerald-600 hover:bg-emerald-700 text-white px-4 py-2 rounded-lg">ğŸ“– Baca Penerangan</button>
          </div>
        </div>
      </div>
    </div>`;
  const sl = document.getElementById('sl');
  const sayNum = ()=>{ info(`Nombor ${sl.value}.`); speak(`Nombor ${sl.value}`); };
  const sayDesc= ()=>{
    const v=+sl.value, prev=v-1, next=v+1;
    const text = v===11 ? `Sebelas datang selepas sepuluh dan sebelum dua belas.` :
                v===20 ? `Dua puluh ialah hujung julat; sebelumnya sembilan belas.` :
                `${v} datang selepas ${prev} dan sebelum ${next}.`;
    info(text); speak(text);
  };
  sl.oninput=()=>{ document.querySelector('#stage .text-5xl').textContent=sl.value; speak(`Nombor ${sl.value}`); info(`Nombor ${sl.value}.`); };
  document.getElementById('sNum').onclick=sayNum;
  document.getElementById('sDesc').onclick=sayDesc;
  info(`Peluncur berada pada ${n}. Klik â€œSebut Nomborâ€ atau â€œBaca Peneranganâ€.`);
}

/* -------------------- Aktiviti 2: Kotak Manik (Penambahan) -------------------- */
function act2(){
  const sets = [{r:6,b:7},{r:4,b:5},{r:3,b:8},{r:5,b:6}];
  const pick = sets[step % sets.length];
  const beadRow = (n, color) => Array.from({length:n}).map(_=> `<div draggable="true" class="w-8 h-8 ${color} rounded-full border-2 ${color==='bg-red-500'?'border-red-600':'border-blue-600'}"></div>`).join('');
  document.getElementById('stage').innerHTML = `
    <div class="w-full">
      <h2 class="text-2xl font-bold text-green-800 mb-2">ğŸ§µ Kotak Manik (Penambahan)</h2>
      <p class="text-slate-600 mb-4">Seret manik merah & biru ke dalam kotak untuk mengira jumlah. Tiada tanda salah/betul â€” hanya penerangan.</p>

      <div class="grid md:grid-cols-2 gap-6">
        <div class="card p-5">
          <h3 class="font-bold mb-2">Manik Tersedia</h3>
          <div class="flex flex-wrap gap-2 mb-3" id="srcR">${beadRow(pick.r,'bg-red-500')}</div>
          <div class="flex flex-wrap gap-2" id="srcB">${beadRow(pick.b,'bg-blue-500')}</div>
        </div>
        <div class="card p-5">
          <h3 class="font-bold mb-2">Kotak Pengumpulan</h3>
          <div id="dz" class="dropzone-dashed rounded-xl min-h-[120px] p-4 flex flex-wrap gap-2 items-center justify-center">
            <span class="text-slate-400">Seret ke sini</span>
          </div>
          <div class="text-center mt-4 text-lg">Jumlah manik: <span id="tot" class="text-2xl font-extrabold">0</span></div>
        </div>
      </div>
    </div>`;
  info(`Ada ${pick.r} manik merah dan ${pick.b} manik biru. Seret ke kotak untuk lihat jumlahnya.`);

  enableBeadDrag();
}
function enableBeadDrag(){
  const dz=document.getElementById('dz');
  document.querySelectorAll('#srcR div,#srcB div').forEach(el=>{
    el.addEventListener('dragstart',e=>{
      e.dataTransfer.setData('text/plain', e.target.outerHTML);
    });
  });
  dz.ondragover=(e)=>{e.preventDefault(); dz.classList.add('ring-4','ring-blue-300');};
  dz.ondragleave=()=>dz.classList.remove('ring-4','ring-blue-300');
  dz.ondrop=(e)=>{e.preventDefault(); dz.classList.remove('ring-4','ring-blue-300');
    const html=e.dataTransfer.getData('text/plain');
    if(dz.querySelector('span')) dz.innerHTML='';
    dz.insertAdjacentHTML('beforeend', html);
    document.getElementById('tot').textContent = dz.querySelectorAll('div[draggable="true"]').length;
    info(`Jumlah semasa: ${document.getElementById('tot').textContent} manik.`);
  };
}

/* -------------------- Aktiviti 3: Keluarga Jumlah -------------------- */
function act3(){
  const target = [8,9,10,11][step%4];
  const families = {
    8: [[5,3],[4,4],[6,2],[7,1]],
    9: [[4,5],[6,3],[7,2],[8,1]],
    10:[[6,4],[7,3],[8,2],[9,1]],
    11:[[5,6],[7,4],[8,3],[9,2]]
  }[target];
  const cards = families.map(([a,b])=>`
    <button class="group card p-4 hover:shadow-xl transition">
      <div class="text-3xl font-extrabold">${a} + ${b} = ${a+b}</div>
      <div class="text-slate-500 group-hover:text-slate-700">Jumlah ${a}+${b} diterangkan sebagai ${a} dan ${b} digabungkan.</div>
    </button>`).join('');
  document.getElementById('stage').innerHTML = `
    <div class="w-full">
      <h2 class="text-2xl font-bold text-fuchsia-800 mb-2">ğŸ‘¨â€ğŸ‘©â€ğŸ‘§ Keluarga Jumlah â€” Sasaran ${target}</h2>
      <p class="text-slate-600 mb-4">Klik mana-mana kad untuk mendengar penjelasan.</p>
      <div class="grid md:grid-cols-2 gap-4">${cards}</div>
    </div>`;
  info(`Semua ayat tambah yang menghasilkan ${target}.`);
  document.querySelectorAll('#stage button').forEach(btn=>{
    btn.onclick=()=>{
      const t=btn.querySelector('.text-3xl').textContent;
      info(`Ayat ${t} â€” kedua-dua nombor digabungkan menjadi ${target}.`);
      speak(`Ayat ${t}. Jumlahnya ${target}.`);
      btn.classList.add('bounce');
      setTimeout(()=>btn.classList.remove('bounce'),500);
    };
  });
}

/* -------------------- Aktiviti 4: Domino Tambah (fixed) -------------------- */
function pipHTML(n, color){
  const POS={0:[],1:[5],2:[1,9],3:[1,5,9],4:[1,3,7,9],5:[1,3,5,7,9],6:[1,3,4,6,7,9]};
  return `<div class="face ${color==='black'?'left':'right'}">` +
    Array.from({length:9},(_,i)=> (POS[n]||[]).includes(i+1)?`<div class="pip ${color}"></div>`:`<div></div>`).join('') +
  `</div>`;
}
function dominoHTML(l,r){
  return `<div class="domino" draggable="true" data-left="${l}" data-right="${r}">
    ${pipHTML(l,'black')}${pipHTML(r,'red')}
  </div>`;
}
function act4(){
  const set=[[6,2],[5,3],[4,4],[6,3],[5,4],[6,4],[5,5]];
  const html=set.map(([l,r])=>dominoHTML(l,r)).join('');
  document.getElementById('stage').innerHTML=`
    <div class="w-full">
      <h2 class="text-2xl font-bold text-orange-800 mb-2">ğŸ² Domino Tambah</h2>
      <p class="text-slate-600 mb-4">Pip kiri <b>hitam</b>, pip kanan <b class="text-red-600">merah</b>. Seret satu kad ke kotak untuk lihat jumlah.</p>
      <div class="grid md:grid-cols-2 gap-6">
        <div class="card p-5">
          <h3 class="font-bold mb-2">Kad Domino</h3>
          <div id="domList" class="flex flex-wrap gap-3">${html}</div>
        </div>
        <div class="card p-5">
          <h3 class="font-bold mb-2">Kotak Jumlah</h3>
          <div id="domDrop" class="dropzone-dashed rounded-xl min-h-[140px] p-5 flex items-center justify-center"
               ondragover="domOver(event)" ondragleave="domLeave(event)" ondrop="domDrop(event)">
            <span class="text-slate-400">Seret kad ke sini</span>
          </div>
          <div class="text-center mt-4 text-xl">Jumlah pip:
            <span id="domTot" class="text-2xl font-extrabold">0</span>
          </div>
        </div>
      </div>
    </div>`;
  info('Seret mana-mana kad ke kotak. Jumlah dikira terus dari nilai kiri+kanan.');
  // enable drag
  document.querySelectorAll('#domList .domino').forEach(el=>{
    el.addEventListener('dragstart',e=>{
      e.dataTransfer.setData('text/plain', JSON.stringify({left:+el.dataset.left,right:+el.dataset.right,html:el.outerHTML}));
      el.classList.add('dragging');
    });
    el.addEventListener('dragend',()=>el.classList.remove('dragging'));
  });
}
function domOver(e){e.preventDefault(); e.currentTarget.classList.add('ring-4','ring-indigo-300');}
function domLeave(e){e.currentTarget.classList.remove('ring-4','ring-indigo-300');}
function domDrop(e){
  e.preventDefault();
  const data=JSON.parse(e.dataTransfer.getData('text/plain'));
  const dz=document.getElementById('domDrop');
  dz.classList.remove('ring-4','ring-indigo-300');
  dz.innerHTML=data.html; // hanya satu kad di dalam
  const total=(Number.isFinite(data.left)?data.left:0)+(Number.isFinite(data.right)?data.right:0);
  document.getElementById('domTot').textContent=total;
  info(`Jumlah pip pada kad ialah ${total}.`);
  speak(`Jumlah pip ${total}`);
}

/* -------------------- Aktiviti 5: Kad Petak 100 -------------------- */
function act5(){
  const grid = Array.from({length:100},(_,i)=>i+1).map(n=>`
    <button data-n="${n}" class="w-10 h-10 md:w-12 md:h-12 m-1 rounded-lg border border-slate-300 bg-white hover:bg-slate-100">${n}</button>
  `).join('');
  document.getElementById('stage').innerHTML=`
    <div class="w-full">
      <h2 class="text-2xl font-bold text-amber-800 mb-2">ğŸ”¢ Kad Petak 100</h2>
      <p class="text-slate-600 mb-4">Klik mana-mana nombor untuk lihat â€œlebih satuâ€ secara visual.</p>
      <div class="card p-4">
        <div id="grid" class="flex flex-wrap justify-center">${grid}</div>
      </div>
    </div>`;
  info('Klik satu nombor â€” sistem akan menerangkan â€œlebih satuâ€.');
  document.querySelectorAll('#grid button').forEach(btn=>{
    btn.onclick=()=>{
      document.querySelectorAll('#grid button').forEach(b=>b.classList.remove('bg-green-200','border-green-500','text-green-900','bg-blue-200','border-blue-500','text-blue-900'));
      const n=+btn.dataset.n;
      const next=n+1>100?null:n+1;
      btn.classList.add('bg-blue-200','border-blue-500','text-blue-900');
      if(next){
        const nb=document.querySelector(`#grid button[data-n="${next}"]`);
        nb.classList.add('bg-green-200','border-green-500','text-green-900');
        info(`Lebih satu daripada ${n} ialah ${next}.`);
        speak(`Lebih satu daripada ${n} ialah ${next}`);
      }else{
        info(`${n} ialah nombor terakhir dalam kad ini.`);
        speak(`${n} ialah nombor terakhir dalam kad ini`);
      }
    };
  });
}

/* init */
resetStage();
</script>
</body>
</html>
